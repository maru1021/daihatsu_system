const BASE_JS_NAMESPACE='baseJs';let isInitialLoad=true;function performInitialization(){initializeSelect2();initializeDatepickers();initializeMachineSelect();initializeToolNoSelect();initializeTableMasterPage();initializeImageUpload();focusSearchInput();showRegisterModal();if(typeof initializeImprovementSchedulePage==='function'){initializeImprovementSchedulePage();}}
$(document).ready(function(){if(isInitialLoad){clearInitializationFlags();performInitialization();isInitialLoad=false;}});$(document).off(`htmx:afterSettle.${BASE_JS_NAMESPACE}`).on(`htmx:afterSettle.${BASE_JS_NAMESPACE}`,function(evt){if(!isInitialLoad){clearInitializationFlags();setTimeout(()=>{performInitialization();},50);}});$(document).off(`htmx:beforeSwap.${BASE_JS_NAMESPACE}`).on(`htmx:beforeSwap.${BASE_JS_NAMESPACE}`,function(evt){cleanupModalSelect2();$(document).off('.tableEvents .tableMaster .tableSearch .pagination .editForm .deleteConfirm');});$(document).off(`show.bs.modal.${BASE_JS_NAMESPACE}`).on(`show.bs.modal.${BASE_JS_NAMESPACE}`,function(evt){$('.select2-container--open').remove();$('.select2-dropdown').remove();});$(document).off(`shown.bs.modal.${BASE_JS_NAMESPACE}`).on(`shown.bs.modal.${BASE_JS_NAMESPACE}`,function(evt){const modalElement=$(evt.target);if(modalElement){const modalId=modalElement.attr('id');if(modalId==='RegisterModal'){initializeRegisterModalSelect2();}else if(modalId==='EditModal'){const $modal=$('#EditModal');$modal.find('.select2').each(function(){const $element=$(this);if($element.data('select2')){$element.off('select2:opening select2:open select2:closing select2:close select2:selecting select2:select select2:unselecting select2:unselect');$element.select2('destroy');$element.next('.select2-container').remove();}
$element.select2({theme:'bootstrap-5',width:'100%',placeholder:'選択してください',allowClear:true,dropdownParent:$modal});});}
focusFirstInput(modalElement);}});$(document).off(`hide.bs.modal.${BASE_JS_NAMESPACE}`).on(`hide.bs.modal.${BASE_JS_NAMESPACE}`,function(evt){removeAllFocus();});$(document).off(`hidden.bs.modal.${BASE_JS_NAMESPACE}`).on(`hidden.bs.modal.${BASE_JS_NAMESPACE}`,function(evt){const modalElement=$(evt.target);$('.select2-container--open').remove();$('.select2-dropdown').remove();cleanupModalSelect2();cleanupModals();clearFormErrors(modalElement);focusSearchInput();});;