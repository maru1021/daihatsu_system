$(function(){const STORAGE_KEY="sidebarState";const getStoredState=()=>{try{return JSON.parse(sessionStorage.getItem(STORAGE_KEY)||"{}");}catch{return{};}};const saveCurrentDOMState=()=>{const state={};$(".collapse").each((i,el)=>{state[el.id]=$(el).hasClass("show");});sessionStorage.setItem(STORAGE_KEY,JSON.stringify(state));};const restoreStates=()=>{const state=getStoredState();Object.keys(state).forEach((elementId)=>{const $element=$("#"+elementId);const $trigger=$(`[data-bs-target="#${elementId}"]`);const shouldBeOpen=state[elementId];const isCurrentlyOpen=$element.hasClass("show");if($element.length&&shouldBeOpen!==isCurrentlyOpen){if(shouldBeOpen){$element.addClass("show");$trigger.attr("aria-expanded","true");}else{$element.removeClass("show");$trigger.attr("aria-expanded","false");}}});};$(".collapse").on("shown.bs.collapse hidden.bs.collapse",function(){saveCurrentDOMState();});setTimeout(()=>{restoreStates();},0);function initSidebarScroll(){const sidebar=document.querySelector('.sidebar');if(!sidebar)return;sidebar.addEventListener('wheel',function(e){const scrollTop=sidebar.scrollTop;const scrollHeight=sidebar.scrollHeight;const height=sidebar.clientHeight;const delta=e.deltaY;if(scrollHeight>height){if((scrollTop===0&&delta<0)||(scrollTop+height>=scrollHeight&&delta>0)){e.preventDefault();e.stopPropagation();}}},{passive:false});sidebar.addEventListener('touchmove',function(e){const scrollHeight=sidebar.scrollHeight;const height=sidebar.clientHeight;if(scrollHeight>height){e.stopPropagation();}},{passive:false});}
initSidebarScroll();document.addEventListener('htmx:afterSettle',function(){initSidebarScroll();});});;