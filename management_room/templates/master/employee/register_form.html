<!-- 新規追加時フォーム -->
<div class="mb-3">
  <label for="name" class="form-label">従業員名 <span class="text-danger">*</span></label>
  <input type="text" class="form-control" id="name" name="name" value="">
</div>
<div class="mb-3">
  <label for="employee_number" class="form-label">従業員番号 <span class="text-danger"></span></label>
  <input type="text" class="form-control" id="employee_number" name="employee_number" value="">
</div>
<div class="mb-3">
  <label class="form-label">部署 <span class="text-danger"></span></label>
  <div id="department-container" class="variable-form">
    <div class="department-row mb-2">
      <div class="input-group">
        <select class="form-control select2" name="department[]">
          <option value="">選択してください</option>
          {% for department in departments %}
            <option value="{{ department.id }}">{{ department.name }}</option>
          {% endfor %}
        </select>
        <button type="button" class="btn btn-outline-success add-department" title="部署を追加">
          <i class="fas fa-plus"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<div class="mb-3">
  <label for="line" class="form-label">ライン <span class="text-danger"></span></label>
  <select class="form-control select2" id="line" name="line">
    <option value="">選択してください</option>
    {% for line in lines %}
    <option value="{{ line.id }}">{{ line.name }}</option>
    {% endfor %}
  </select>
</div>
<div class="mb-3">
  <label for="email" class="form-label">メールアドレス <span class="text-danger"></span></label>
  <input type="email" class="form-control" id="email" name="email" value="">
</div>
<div class="mb-3">
  <label for="phone_number" class="form-label">内線番号 <span class="text-danger"></span></label>
  <input type="text" class="form-control" id="phone_number" name="phone_number" value="">
</div>

<style>
.department-row .input-group {
    align-items: stretch;
}

.department-row .input-group .select2-container {
    flex: 1;
}

.department-row .input-group .btn {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
}
</style>

<script>
  window.employeeDepartmentMasterFormLoad = false;

  function initializeEmployeeDepartmentMasterForm() {
    if (typeof $ !== 'undefined') {
      const departmentData = [
        {% for department in departments %}
        {id: {{ department.id }}, name: "{{ department.name|escapejs }}"}{% if not forloop.last %},{% endif %}
        {% endfor %}
      ];
      initializeVariableForm('department', departmentData);
      window.employeeDepartmentMasterFormLoad = true;
    } else {
      setTimeout(initializeEmployeeDepartmentMasterForm, 50);
    }
  }

  if (!employeeDepartmentMasterFormLoad) {
    initializeEmployeeDepartmentMasterForm();
  }
</script>
